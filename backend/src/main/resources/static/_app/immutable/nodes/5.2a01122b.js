import{s as Tt,f as c,l as M,a as g,g as u,h as f,m as L,d as o,c as y,J as Vt,j as s,i as le,w as e,z as Pe,O as Ct,n as z,u as _t,o as Mt,F as Ye,G as Ze,L as je,P as xt,H as Dt,y as $e,I as We,K as Lt}from"../chunks/scheduler.55755e91.js";import{S as Bt,i as Ht,t as ct,c as Pt,a as ut,g as At,b as Ot,d as St,m as zt,e as jt}from"../chunks/index.d2ed93bc.js";import{e as bt}from"../chunks/each.8720bd6f.js";import{s as De,g as Wt}from"../chunks/navigation.fbd60083.js";import{c as it,a as Ft}from"../chunks/api.20dd9789.js";import{S as Jt}from"../chunks/Spinner.50375aac.js";import{a as Ut,o as qt}from"../chunks/pdfGenerator.aa2f9fb1.js";import{p as Rt}from"../chunks/stores.bcd3e6fb.js";import{t as Gt}from"../chunks/index.7dc5fa01.js";import{f as gt}from"../chunks/index.7c030542.js";import{a as Kt}from"../chunks/index.e61f0a07.js";function yt(n,t,r){const a=n.slice();return a[22]=t[r],a}function Qt(n){let t,r,a,i='<svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg>',h,l,E,p=n[6]("cessions.create.selected_client")+"",_,F,D,A,V,W=n[6]("cessions.create.name")+"",j,w,N,O=n[0].clientName+"",B,G,b,x,U=n[6]("cessions.create.cin")+"",d,T,H,k=n[0].clientCin+"",J,I,m,v,C=n[6]("cessions.create.client_number")+"",X,Y,Z,q=n[0].clientNumber+"",$,be,ue,ge,se=n[6]("cessions.create.job")+"",fe,ye,de,ke=(n[0].clientJob||"Not specified")+"",Be,Ee,ne,pe,Ae=n[6]("cessions.create.workplace")+"",me,we,he,Ie=(n[0].clientWorkplace||"Not specified")+"",He,Ne,oe,ve,xe=n[6]("cessions.create.address")+"",re,ae,ee,ie=(n[0].clientAddress||"Not specified")+"",Oe,Te,_e,ce,te="",Se,ze;return{c(){t=c("div"),r=c("div"),a=c("div"),a.innerHTML=i,h=g(),l=c("div"),E=c("h3"),_=M(p),F=g(),D=c("div"),A=c("div"),V=c("p"),j=M(W),w=g(),N=c("p"),B=M(O),G=g(),b=c("div"),x=c("p"),d=M(U),T=g(),H=c("p"),J=M(k),I=g(),m=c("div"),v=c("p"),X=M(C),Y=g(),Z=c("p"),$=M(q),be=g(),ue=c("div"),ge=c("p"),fe=M(se),ye=g(),de=c("p"),Be=M(ke),Ee=g(),ne=c("div"),pe=c("p"),me=M(Ae),we=g(),he=c("p"),He=M(Ie),Ne=g(),oe=c("div"),ve=c("p"),re=M(xe),ae=g(),ee=c("p"),Oe=M(ie),Te=g(),_e=c("div"),ce=c("button"),ce.innerHTML=te,this.h()},l(R){t=u(R,"DIV",{class:!0});var K=f(t);r=u(K,"DIV",{class:!0});var Fe=f(r);a=u(Fe,"DIV",{class:!0,"data-svelte-h":!0}),$e(a)!=="svelte-ze9m2j"&&(a.innerHTML=i),h=y(Fe),l=u(Fe,"DIV",{class:!0});var Q=f(l);E=u(Q,"H3",{class:!0});var S=f(E);_=L(S,p),S.forEach(o),F=y(Q),D=u(Q,"DIV",{class:!0});var P=f(D);A=u(P,"DIV",{});var Je=f(A);V=u(Je,"P",{class:!0});var Ve=f(V);j=L(Ve,W),Ve.forEach(o),w=y(Je),N=u(Je,"P",{class:!0});var Ue=f(N);B=L(Ue,O),Ue.forEach(o),Je.forEach(o),G=y(P),b=u(P,"DIV",{});var qe=f(b);x=u(qe,"P",{class:!0});var tt=f(x);d=L(tt,U),tt.forEach(o),T=y(qe),H=u(qe,"P",{class:!0});var Re=f(H);J=L(Re,k),Re.forEach(o),qe.forEach(o),I=y(P),m=u(P,"DIV",{});var Ge=f(m);v=u(Ge,"P",{class:!0});var lt=f(v);X=L(lt,C),lt.forEach(o),Y=y(Ge),Z=u(Ge,"P",{class:!0});var Ce=f(Z);$=L(Ce,q),Ce.forEach(o),Ge.forEach(o),be=y(P),ue=u(P,"DIV",{});var Ke=f(ue);ge=u(Ke,"P",{class:!0});var st=f(ge);fe=L(st,se),st.forEach(o),ye=y(Ke),de=u(Ke,"P",{class:!0});var rt=f(de);Be=L(rt,ke),rt.forEach(o),Ke.forEach(o),Ee=y(P),ne=u(P,"DIV",{});var Me=f(ne);pe=u(Me,"P",{class:!0});var at=f(pe);me=L(at,Ae),at.forEach(o),we=y(Me),he=u(Me,"P",{class:!0});var Qe=f(he);He=L(Qe,Ie),Qe.forEach(o),Me.forEach(o),Ne=y(P),oe=u(P,"DIV",{});var Le=f(oe);ve=u(Le,"P",{class:!0});var nt=f(ve);re=L(nt,xe),nt.forEach(o),ae=y(Le),ee=u(Le,"P",{class:!0});var ot=f(ee);Oe=L(ot,ie),ot.forEach(o),Le.forEach(o),P.forEach(o),Te=y(Q),_e=u(Q,"DIV",{class:!0});var Xe=f(_e);ce=u(Xe,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$e(ce)!=="svelte-1eypouf"&&(ce.innerHTML=te),Xe.forEach(o),Q.forEach(o),Fe.forEach(o),K.forEach(o),this.h()},h(){s(a,"class","flex-shrink-0"),s(E,"class","text-sm font-medium text-blue-800"),s(V,"class","text-xs text-blue-700"),s(N,"class","text-sm font-medium text-blue-900"),s(x,"class","text-xs text-blue-700"),s(H,"class","text-sm font-medium text-blue-900"),s(v,"class","text-xs text-blue-700"),s(Z,"class","text-sm font-medium text-blue-900"),s(ge,"class","text-xs text-blue-700"),s(de,"class","text-sm font-medium text-blue-900"),s(pe,"class","text-xs text-blue-700"),s(he,"class","text-sm font-medium text-blue-900"),s(ve,"class","text-xs text-blue-700"),s(ee,"class","text-sm font-medium text-blue-900"),s(D,"class","mt-2 grid grid-cols-1 gap-2 sm:grid-cols-3"),s(ce,"type","button"),s(ce,"class","text-sm text-blue-600 hover:text-blue-900"),s(_e,"class","mt-4"),s(l,"class","ml-3 flex-1"),s(r,"class","flex items-start"),s(t,"class","bg-blue-50 border border-blue-200 rounded-lg p-4")},m(R,K){le(R,t,K),e(t,r),e(r,a),e(r,h),e(r,l),e(l,E),e(E,_),e(l,F),e(l,D),e(D,A),e(A,V),e(V,j),e(A,w),e(A,N),e(N,B),e(D,G),e(D,b),e(b,x),e(x,d),e(b,T),e(b,H),e(H,J),e(D,I),e(D,m),e(m,v),e(v,X),e(m,Y),e(m,Z),e(Z,$),e(D,be),e(D,ue),e(ue,ge),e(ge,fe),e(ue,ye),e(ue,de),e(de,Be),e(D,Ee),e(D,ne),e(ne,pe),e(pe,me),e(ne,we),e(ne,he),e(he,He),e(D,Ne),e(D,oe),e(oe,ve),e(ve,re),e(oe,ae),e(oe,ee),e(ee,Oe),e(l,Te),e(l,_e),e(_e,ce),Se||(ze=Pe(ce,"click",n[14]),Se=!0)},p(R,K){K&64&&p!==(p=R[6]("cessions.create.selected_client")+"")&&z(_,p),K&64&&W!==(W=R[6]("cessions.create.name")+"")&&z(j,W),K&1&&O!==(O=R[0].clientName+"")&&z(B,O),K&64&&U!==(U=R[6]("cessions.create.cin")+"")&&z(d,U),K&1&&k!==(k=R[0].clientCin+"")&&z(J,k),K&64&&C!==(C=R[6]("cessions.create.client_number")+"")&&z(X,C),K&1&&q!==(q=R[0].clientNumber+"")&&z($,q),K&64&&se!==(se=R[6]("cessions.create.job")+"")&&z(fe,se),K&1&&ke!==(ke=(R[0].clientJob||"Not specified")+"")&&z(Be,ke),K&64&&Ae!==(Ae=R[6]("cessions.create.workplace")+"")&&z(me,Ae),K&1&&Ie!==(Ie=(R[0].clientWorkplace||"Not specified")+"")&&z(He,Ie),K&64&&xe!==(xe=R[6]("cessions.create.address")+"")&&z(re,xe),K&1&&ie!==(ie=(R[0].clientAddress||"Not specified")+"")&&z(Oe,ie)},i:We,o:We,d(R){R&&o(t),Se=!1,ze()}}}function Xt(n){let t,r,a,i,h=n[6]("cessions.create.search_client")+"",l,E,p,_,F,D,A,V='<svg class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg>',W,j,w,N,O,B,G="Search by full name, CIN number, or worker number",b,x,U,d;const T=[Zt,Yt],H=[];function k(v,C){return v[4]?0:v[1]?1:-1}~(w=k(n))&&(N=H[w]=T[w](n));function J(v,C){if(v[2].length>0)return tl;if(v[1].length>=2&&!v[4])return el;if(v[1].length>0&&v[1].length<2)return $t}let I=J(n),m=I&&I(n);return{c(){t=c("div"),r=c("div"),a=c("div"),i=c("label"),l=M(h),E=g(),p=c("div"),_=c("input"),D=g(),A=c("div"),A.innerHTML=V,W=g(),j=c("div"),N&&N.c(),O=g(),B=c("p"),B.textContent=G,b=g(),m&&m.c(),this.h()},l(v){t=u(v,"DIV",{class:!0});var C=f(t);r=u(C,"DIV",{class:!0});var X=f(r);a=u(X,"DIV",{});var Y=f(a);i=u(Y,"LABEL",{for:!0,class:!0});var Z=f(i);l=L(Z,h),Z.forEach(o),E=y(Y),p=u(Y,"DIV",{class:!0});var q=f(p);_=u(q,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),D=y(q),A=u(q,"DIV",{class:!0,"data-svelte-h":!0}),$e(A)!=="svelte-mmprme"&&(A.innerHTML=V),W=y(q),j=u(q,"DIV",{class:!0});var $=f(j);N&&N.l($),$.forEach(o),q.forEach(o),O=y(Y),B=u(Y,"P",{class:!0,"data-svelte-h":!0}),$e(B)!=="svelte-7qi8u2"&&(B.textContent=G),Y.forEach(o),X.forEach(o),b=y(C),m&&m.l(C),C.forEach(o),this.h()},h(){s(i,"for","searchTerm"),s(i,"class","block text-sm font-medium text-gray-700"),s(_,"type","text"),s(_,"id","searchTerm"),s(_,"placeholder",F=n[6]("cessions.create.search_client")),s(_,"class","block w-full rounded-md border-gray-300 pl-10 pr-10 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),s(A,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),s(j,"class","absolute inset-y-0 right-0 pr-3 flex items-center"),s(p,"class","mt-1 relative rounded-md shadow-sm"),s(B,"class","mt-1 text-xs text-gray-500"),s(r,"class","grid grid-cols-1 md:grid-cols-2 gap-4"),s(t,"class","space-y-4")},m(v,C){le(v,t,C),e(t,r),e(r,a),e(a,i),e(i,l),e(a,E),e(a,p),e(p,_),je(_,n[1]),e(p,D),e(p,A),e(p,W),e(p,j),~w&&H[w].m(j,null),e(a,O),e(a,B),e(t,b),m&&m.m(t,null),x=!0,U||(d=[Pe(_,"input",n[11]),Pe(_,"input",n[7])],U=!0)},p(v,C){(!x||C&64)&&h!==(h=v[6]("cessions.create.search_client")+"")&&z(l,h),(!x||C&64&&F!==(F=v[6]("cessions.create.search_client")))&&s(_,"placeholder",F),C&2&&_.value!==v[1]&&je(_,v[1]);let X=w;w=k(v),w===X?~w&&H[w].p(v,C):(N&&(At(),ct(H[X],1,1,()=>{H[X]=null}),Pt()),~w?(N=H[w],N?N.p(v,C):(N=H[w]=T[w](v),N.c()),ut(N,1),N.m(j,null)):N=null),I===(I=J(v))&&m?m.p(v,C):(m&&m.d(1),m=I&&I(v),m&&(m.c(),m.m(t,null)))},i(v){x||(ut(N),x=!0)},o(v){ct(N),x=!1},d(v){v&&o(t),~w&&H[w].d(),m&&m.d(),U=!1,Dt(d)}}}function Yt(n){let t,r='<svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',a,i;return{c(){t=c("button"),t.innerHTML=r,this.h()},l(h){t=u(h,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-1flduex"&&(t.innerHTML=r),this.h()},h(){s(t,"type","button"),s(t,"class","text-gray-400 hover:text-gray-600")},m(h,l){le(h,t,l),a||(i=Pe(t,"click",n[12]),a=!0)},p:We,i:We,o:We,d(h){h&&o(t),a=!1,i()}}}function Zt(n){let t,r;return t=new Jt({}),{c(){Ot(t.$$.fragment)},l(a){St(t.$$.fragment,a)},m(a,i){zt(t,a,i),r=!0},p:We,i(a){r||(ut(t.$$.fragment,a),r=!0)},o(a){ct(t.$$.fragment,a),r=!1},d(a){jt(t,a)}}}function $t(n){let t,r="Please enter at least 2 characters to search.";return{c(){t=c("p"),t.textContent=r,this.h()},l(a){t=u(a,"P",{class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-r3xqty"&&(t.textContent=r),this.h()},h(){s(t,"class","text-sm text-gray-500 text-center py-4")},m(a,i){le(a,t,i)},p:We,d(a){a&&o(t)}}}function el(n){let t,r='<svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0118 12a8 8 0 10-8 8 7.962 7.962 0 01-5.291-2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No clients found</h3> <p class="mt-1 text-sm text-gray-500">No clients match your search criteria.</p> <p class="mt-1 text-xs text-gray-400">Try searching by full name, CIN, or worker number.</p>';return{c(){t=c("div"),t.innerHTML=r,this.h()},l(a){t=u(a,"DIV",{class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-s1isxq"&&(t.innerHTML=r),this.h()},h(){s(t,"class","text-center py-8")},m(a,i){le(a,t,i)},p:We,d(a){a&&o(t)}}}function tl(n){let t,r=bt(n[2]),a=[];for(let i=0;i<r.length;i+=1)a[i]=wt(yt(n,r,i));return{c(){t=c("div");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){t=u(i,"DIV",{class:!0});var h=f(t);for(let l=0;l<a.length;l+=1)a[l].l(h);h.forEach(o),this.h()},h(){s(t,"class","mt-4 space-y-2")},m(i,h){le(i,t,h);for(let l=0;l<a.length;l+=1)a[l]&&a[l].m(t,null)},p(i,h){if(h&260){r=bt(i[2]);let l;for(l=0;l<r.length;l+=1){const E=yt(i,r,l);a[l]?a[l].p(E,h):(a[l]=wt(E),a[l].c(),a[l].m(t,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=r.length}},d(i){i&&o(t),Lt(a,i)}}}function kt(n){let t,r,a=n[22].clientNumber+"",i;return{c(){t=c("p"),r=M("Worker #: "),i=M(a),this.h()},l(h){t=u(h,"P",{class:!0});var l=f(t);r=L(l,"Worker #: "),i=L(l,a),l.forEach(o),this.h()},h(){s(t,"class","text-xs text-gray-500")},m(h,l){le(h,t,l),e(t,r),e(t,i)},p(h,l){l&4&&a!==(a=h[22].clientNumber+"")&&z(i,a)},d(h){h&&o(t)}}}function Et(n){let t,r,a=n[22].jobTitle+"",i;return{c(){t=c("p"),r=M("Job: "),i=M(a),this.h()},l(h){t=u(h,"P",{class:!0});var l=f(t);r=L(l,"Job: "),i=L(l,a),l.forEach(o),this.h()},h(){s(t,"class","text-xs text-gray-500")},m(h,l){le(h,t,l),e(t,r),e(t,i)},p(h,l){l&4&&a!==(a=h[22].jobTitle+"")&&z(i,a)},d(h){h&&o(t)}}}function wt(n){let t,r,a,i,h=n[22].fullName+"",l,E,p,_,F,D=n[22].cin+"",A,V,W,j,w,N,O,B,G,b=n[22].clientNumber&&kt(n),x=n[22].jobTitle&&Et(n);function U(){return n[13](n[22])}return{c(){t=c("button"),r=c("div"),a=c("div"),i=c("p"),l=M(h),E=g(),p=c("div"),_=c("p"),F=M("CIN: "),A=M(D),V=g(),b&&b.c(),W=g(),x&&x.c(),j=g(),w=Ye("svg"),N=Ye("path"),O=g(),this.h()},l(d){t=u(d,"BUTTON",{type:!0,class:!0});var T=f(t);r=u(T,"DIV",{class:!0});var H=f(r);a=u(H,"DIV",{class:!0});var k=f(a);i=u(k,"P",{class:!0});var J=f(i);l=L(J,h),J.forEach(o),E=y(k),p=u(k,"DIV",{class:!0});var I=f(p);_=u(I,"P",{class:!0});var m=f(_);F=L(m,"CIN: "),A=L(m,D),m.forEach(o),V=y(I),b&&b.l(I),W=y(I),x&&x.l(I),I.forEach(o),k.forEach(o),j=y(H),w=Ze(H,"svg",{class:!0,viewBox:!0,fill:!0});var v=f(w);N=Ze(v,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),f(N).forEach(o),v.forEach(o),H.forEach(o),O=y(T),T.forEach(o),this.h()},h(){s(i,"class","text-sm font-medium text-gray-900"),s(_,"class","text-xs text-gray-500"),s(p,"class","flex space-x-4 mt-1"),s(a,"class","flex-1"),s(N,"fill-rule","evenodd"),s(N,"d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"),s(N,"clip-rule","evenodd"),s(w,"class","h-5 w-5 text-gray-400 flex-shrink-0"),s(w,"viewBox","0 0 20 20"),s(w,"fill","currentColor"),s(r,"class","flex justify-between items-center"),s(t,"type","button"),s(t,"class","w-full text-left p-4 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors")},m(d,T){le(d,t,T),e(t,r),e(r,a),e(a,i),e(i,l),e(a,E),e(a,p),e(p,_),e(_,F),e(_,A),e(p,V),b&&b.m(p,null),e(p,W),x&&x.m(p,null),e(r,j),e(r,w),e(w,N),e(t,O),B||(G=Pe(t,"click",U),B=!0)},p(d,T){n=d,T&4&&h!==(h=n[22].fullName+"")&&z(l,h),T&4&&D!==(D=n[22].cin+"")&&z(A,D),n[22].clientNumber?b?b.p(n,T):(b=kt(n),b.c(),b.m(p,W)):b&&(b.d(1),b=null),n[22].jobTitle?x?x.p(n,T):(x=Et(n),x.c(),x.m(p,null)):x&&(x.d(1),x=null)},d(d){d&&o(t),b&&b.d(),x&&x.d(),B=!1,G()}}}function It(n){let t,r,a=n[6]("cessions.create.cession_details")+"",i,h,l,E,p,_=n[6]("cessions.details.monthly_payment")+"",F,D,A,V,W,j,w,N=n[6]("cessions.details.bank_agency")+"",O,B,G,b,x,U,d,T,H=n[6]("cessions.details.start_date")+"",k,J,I,m,v,C,X=(n[6]("cessions.create.start_date_hint")||"Leave as today or pick another date.")+"",Y,Z,q,$,be=n[6]("cessions.create.summary")+"",ue,ge,se,fe,ye,de=n[6]("cessions.create.total_amount")+"",ke,Be,Ee,ne=et(n[5])+"",pe,Ae,me,we,he=n[6]("cessions.create.monthly_payment")+"",Ie,He,Ne,oe=et(n[0].monthlyPayment)+"",ve,xe,re,ae,ee,ie,Oe,Te=n[6]("cessions.create.preview_pdf")+"",_e,ce,te,Se,ze=n[6]("cessions.create.create_cession")+"",R,K,Fe,Q=n[3]&&Nt();return{c(){t=c("div"),r=c("h2"),i=M(a),h=g(),l=c("div"),E=c("div"),p=c("label"),F=M(_),D=g(),A=c("div"),V=c("input"),W=g(),j=c("div"),w=c("label"),O=M(N),B=g(),G=c("div"),b=c("input"),U=g(),d=c("div"),T=c("label"),k=M(H),J=g(),I=c("div"),m=c("input"),v=g(),C=c("p"),Y=M(X),Z=g(),q=c("div"),$=c("h3"),ue=M(be),ge=g(),se=c("div"),fe=c("div"),ye=c("p"),ke=M(de),Be=g(),Ee=c("p"),pe=M(ne),Ae=g(),me=c("div"),we=c("p"),Ie=M(he),He=g(),Ne=c("p"),ve=M(oe),xe=g(),re=c("div"),ae=c("button"),ee=Ye("svg"),ie=Ye("path"),Oe=g(),_e=M(Te),ce=g(),te=c("button"),Q&&Q.c(),Se=g(),R=M(ze),this.h()},l(S){t=u(S,"DIV",{class:!0});var P=f(t);r=u(P,"H2",{class:!0});var Je=f(r);i=L(Je,a),Je.forEach(o),h=y(P),l=u(P,"DIV",{class:!0});var Ve=f(l);E=u(Ve,"DIV",{});var Ue=f(E);p=u(Ue,"LABEL",{for:!0,class:!0});var qe=f(p);F=L(qe,_),qe.forEach(o),D=y(Ue),A=u(Ue,"DIV",{class:!0});var tt=f(A);V=u(tt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0,step:!0,min:!0}),tt.forEach(o),Ue.forEach(o),W=y(Ve),j=u(Ve,"DIV",{});var Re=f(j);w=u(Re,"LABEL",{for:!0,class:!0});var Ge=f(w);O=L(Ge,N),Ge.forEach(o),B=y(Re),G=u(Re,"DIV",{class:!0});var lt=f(G);b=u(lt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),lt.forEach(o),Re.forEach(o),U=y(Ve),d=u(Ve,"DIV",{});var Ce=f(d);T=u(Ce,"LABEL",{for:!0,class:!0});var Ke=f(T);k=L(Ke,H),Ke.forEach(o),J=y(Ce),I=u(Ce,"DIV",{class:!0});var st=f(I);m=u(st,"INPUT",{type:!0,id:!0,class:!0,max:!0}),st.forEach(o),v=y(Ce),C=u(Ce,"P",{class:!0});var rt=f(C);Y=L(rt,X),rt.forEach(o),Ce.forEach(o),Ve.forEach(o),Z=y(P),q=u(P,"DIV",{class:!0});var Me=f(q);$=u(Me,"H3",{class:!0});var at=f($);ue=L(at,be),at.forEach(o),ge=y(Me),se=u(Me,"DIV",{class:!0});var Qe=f(se);fe=u(Qe,"DIV",{});var Le=f(fe);ye=u(Le,"P",{class:!0});var nt=f(ye);ke=L(nt,de),nt.forEach(o),Be=y(Le),Ee=u(Le,"P",{class:!0});var ot=f(Ee);pe=L(ot,ne),ot.forEach(o),Le.forEach(o),Ae=y(Qe),me=u(Qe,"DIV",{});var Xe=f(me);we=u(Xe,"P",{class:!0});var ht=f(we);Ie=L(ht,he),ht.forEach(o),He=y(Xe),Ne=u(Xe,"P",{class:!0});var pt=f(Ne);ve=L(pt,oe),pt.forEach(o),Xe.forEach(o),Qe.forEach(o),Me.forEach(o),P.forEach(o),xe=y(S),re=u(S,"DIV",{class:!0});var ft=f(re);ae=u(ft,"BUTTON",{type:!0,class:!0});var dt=f(ae);ee=Ze(dt,"svg",{class:!0,xmlns:!0,viewBox:!0,fill:!0});var vt=f(ee);ie=Ze(vt,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),f(ie).forEach(o),vt.forEach(o),Oe=y(dt),_e=L(dt,Te),dt.forEach(o),ce=y(ft),te=u(ft,"BUTTON",{type:!0,class:!0});var mt=f(te);Q&&Q.l(mt),Se=y(mt),R=L(mt,ze),mt.forEach(o),ft.forEach(o),this.h()},h(){s(r,"class","text-lg font-medium text-gray-900 mb-4"),s(p,"for","monthlyPayment"),s(p,"class","block text-sm font-medium text-gray-700"),s(V,"type","number"),s(V,"id","monthlyPayment"),s(V,"class","block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"),s(V,"placeholder","0.000"),s(V,"step","0.001"),s(V,"min","0"),s(A,"class","mt-1"),s(w,"for","bankOrAgency"),s(w,"class","block text-sm font-medium text-gray-700"),s(b,"type","text"),s(b,"id","bankOrAgency"),s(b,"class","block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"),s(b,"placeholder",x=n[6]("cessions.details.bank_agency")),s(G,"class","mt-1"),s(T,"for","startDate"),s(T,"class","block text-sm font-medium text-gray-700"),s(m,"type","date"),s(m,"id","startDate"),s(m,"class","block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"),s(m,"max","9999-12-31"),s(I,"class","mt-1"),s(C,"class","text-xs text-gray-500 mt-1"),s(l,"class","grid grid-cols-1 md:grid-cols-2 gap-6"),s($,"class","text-sm font-medium text-gray-900 mb-2"),s(ye,"class","text-sm text-gray-500"),s(Ee,"class","text-lg font-medium text-gray-900"),s(we,"class","text-sm text-gray-500"),s(Ne,"class","text-lg font-medium text-gray-900"),s(se,"class","grid grid-cols-1 md:grid-cols-2 gap-4"),s(q,"class","mt-6 p-4 bg-gray-50 rounded-lg"),s(t,"class","bg-white shadow rounded-lg p-6"),s(ie,"fill-rule","evenodd"),s(ie,"d","M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"),s(ie,"clip-rule","evenodd"),s(ee,"class","-ml-1 mr-2 h-5 w-5 text-gray-500"),s(ee,"xmlns","http://www.w3.org/2000/svg"),s(ee,"viewBox","0 0 20 20"),s(ee,"fill","currentColor"),s(ae,"type","button"),s(ae,"class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),s(te,"type","submit"),te.disabled=n[3],s(te,"class","inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),s(re,"class","flex justify-end space-x-4")},m(S,P){le(S,t,P),e(t,r),e(r,i),e(t,h),e(t,l),e(l,E),e(E,p),e(p,F),e(E,D),e(E,A),e(A,V),je(V,n[0].monthlyPayment),e(l,W),e(l,j),e(j,w),e(w,O),e(j,B),e(j,G),e(G,b),je(b,n[0].bankOrAgency),e(l,U),e(l,d),e(d,T),e(T,k),e(d,J),e(d,I),e(I,m),je(m,n[0].startDate),e(d,v),e(d,C),e(C,Y),e(t,Z),e(t,q),e(q,$),e($,ue),e(q,ge),e(q,se),e(se,fe),e(fe,ye),e(ye,ke),e(fe,Be),e(fe,Ee),e(Ee,pe),e(se,Ae),e(se,me),e(me,we),e(we,Ie),e(me,He),e(me,Ne),e(Ne,ve),le(S,xe,P),le(S,re,P),e(re,ae),e(ae,ee),e(ee,ie),e(ae,Oe),e(ae,_e),e(re,ce),e(re,te),Q&&Q.m(te,null),e(te,Se),e(te,R),K||(Fe=[Pe(V,"input",n[15]),Pe(b,"input",n[16]),Pe(m,"input",n[17]),Pe(ae,"click",n[10])],K=!0)},p(S,P){P&64&&a!==(a=S[6]("cessions.create.cession_details")+"")&&z(i,a),P&64&&_!==(_=S[6]("cessions.details.monthly_payment")+"")&&z(F,_),P&1&&xt(V.value)!==S[0].monthlyPayment&&je(V,S[0].monthlyPayment),P&64&&N!==(N=S[6]("cessions.details.bank_agency")+"")&&z(O,N),P&64&&x!==(x=S[6]("cessions.details.bank_agency"))&&s(b,"placeholder",x),P&1&&b.value!==S[0].bankOrAgency&&je(b,S[0].bankOrAgency),P&64&&H!==(H=S[6]("cessions.details.start_date")+"")&&z(k,H),P&1&&je(m,S[0].startDate),P&64&&X!==(X=(S[6]("cessions.create.start_date_hint")||"Leave as today or pick another date.")+"")&&z(Y,X),P&64&&be!==(be=S[6]("cessions.create.summary")+"")&&z(ue,be),P&64&&de!==(de=S[6]("cessions.create.total_amount")+"")&&z(ke,de),P&32&&ne!==(ne=et(S[5])+"")&&z(pe,ne),P&64&&he!==(he=S[6]("cessions.create.monthly_payment")+"")&&z(Ie,he),P&1&&oe!==(oe=et(S[0].monthlyPayment)+"")&&z(ve,oe),P&64&&Te!==(Te=S[6]("cessions.create.preview_pdf")+"")&&z(_e,Te),S[3]?Q||(Q=Nt(),Q.c(),Q.m(te,Se)):Q&&(Q.d(1),Q=null),P&64&&ze!==(ze=S[6]("cessions.create.create_cession")+"")&&z(R,ze),P&8&&(te.disabled=S[3])},d(S){S&&(o(t),o(xe),o(re)),Q&&Q.d(),K=!1,Dt(Fe)}}}function Nt(n){let t,r,a;return{c(){t=Ye("svg"),r=Ye("circle"),a=Ye("path"),this.h()},l(i){t=Ze(i,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var h=f(t);r=Ze(h,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),f(r).forEach(o),a=Ze(h,"path",{class:!0,fill:!0,d:!0}),f(a).forEach(o),h.forEach(o),this.h()},h(){s(r,"class","opacity-25"),s(r,"cx","12"),s(r,"cy","12"),s(r,"r","10"),s(r,"stroke","currentColor"),s(r,"stroke-width","4"),s(a,"class","opacity-75"),s(a,"fill","currentColor"),s(a,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),s(t,"class","animate-spin -ml-1 mr-2 h-4 w-4 text-white"),s(t,"xmlns","http://www.w3.org/2000/svg"),s(t,"fill","none"),s(t,"viewBox","0 0 24 24")},m(i,h){le(i,t,h),e(t,r),e(t,a)},d(i){i&&o(t)}}}function ll(n){let t,r,a,i=n[6]("cessions.create.title")+"",h,l,E,p=n[6]("cessions.create.subtitle")+"",_,F,D,A,V,W,j=n[6]("cessions.create.select_client")+"",w,N,O,B,G,b,x,U,d,T;const H=[Xt,Qt],k=[];function J(m,v){return m[0].clientId?1:0}O=J(n),B=k[O]=H[O](n);let I=n[0].clientId&&It(n);return document.title=x=n[6]("cessions.create.title")+" | "+n[6]("common.app_title"),{c(){t=c("div"),r=c("div"),a=c("h1"),h=M(i),l=g(),E=c("p"),_=M(p),F=g(),D=g(),A=c("form"),V=c("div"),W=c("h2"),w=M(j),N=g(),B.c(),G=g(),I&&I.c(),b=g(),this.h()},l(m){t=u(m,"DIV",{class:!0});var v=f(t);r=u(v,"DIV",{class:!0});var C=f(r);a=u(C,"H1",{class:!0});var X=f(a);h=L(X,i),X.forEach(o),l=y(C),E=u(C,"P",{class:!0});var Y=f(E);_=L(Y,p),Y.forEach(o),C.forEach(o),F=y(v),D=y(v),A=u(v,"FORM",{class:!0});var Z=f(A);V=u(Z,"DIV",{class:!0});var q=f(V);W=u(q,"H2",{class:!0});var $=f(W);w=L($,j),$.forEach(o),N=y(q),B.l(q),q.forEach(o),G=y(Z),I&&I.l(Z),Z.forEach(o),v.forEach(o),b=y(m),Vt("svelte-901pd1",document.head).forEach(o),this.h()},h(){s(a,"class","text-2xl font-bold text-gray-900"),s(E,"class","mt-1 text-sm text-gray-500"),s(r,"class","mb-8"),s(W,"class","text-lg font-medium text-gray-900 mb-4"),s(V,"class","bg-white shadow rounded-lg p-6"),s(A,"class","space-y-8"),s(t,"class","max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8")},m(m,v){le(m,t,v),e(t,r),e(r,a),e(a,h),e(r,l),e(r,E),e(E,_),e(t,F),e(t,D),e(t,A),e(A,V),e(V,W),e(W,w),e(V,N),k[O].m(V,null),e(A,G),I&&I.m(A,null),le(m,b,v),U=!0,d||(T=Pe(A,"submit",Ct(n[9])),d=!0)},p(m,[v]){(!U||v&64)&&i!==(i=m[6]("cessions.create.title")+"")&&z(h,i),(!U||v&64)&&p!==(p=m[6]("cessions.create.subtitle")+"")&&z(_,p),(!U||v&64)&&j!==(j=m[6]("cessions.create.select_client")+"")&&z(w,j);let C=O;O=J(m),O===C?k[O].p(m,v):(At(),ct(k[C],1,1,()=>{k[C]=null}),Pt(),B=k[O],B?B.p(m,v):(B=k[O]=H[O](m),B.c()),ut(B,1),B.m(V,null)),m[0].clientId?I?I.p(m,v):(I=It(m),I.c(),I.m(A,null)):I&&(I.d(1),I=null),(!U||v&64)&&x!==(x=m[6]("cessions.create.title")+" | "+m[6]("common.app_title"))&&(document.title=x)},i(m){U||(ut(B),U=!0)},o(m){ct(B),U=!1},d(m){m&&(o(t),o(b)),k[O].d(),I&&I.d(),d=!1,T()}}}function et(n){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:3}).format(n)}function sl(n){const t=["","واحد","اثنان","ثلاثة","أربعة","خمسة","ستة","سبعة","ثمانية","تسعة"],r=["عشرة","أحد عشر","اثنا عشر","ثلاثة عشر","أربعة عشر","خمسة عشر","ستة عشر","سبعة عشر","ثمانية عشر","تسعة عشر"],a=["","","عشرون","ثلاثون","أربعون","خمسون","ستون","سبعون","ثمانون","تسعون"],i=["","مائة","مئتان","ثلاثمائة","أربعمائة","خمسمائة","ستمائة","سبعمائة","ثمانمائة","تسعمائة"],h=["","ألف","مليون","مليار"];if(n===0)return"صفر";let l="",E=0;for(;n>0;){let p=n%1e3;if(p!==0){let _="";if(p>=100&&(_+=i[Math.floor(p/100)]+" ",p%=100),p>0)if(p<10)_+=t[p];else if(p<20)_+=r[p-10];else{let F=p%10,D=Math.floor(p/10);F>0&&(_+=t[F]+" و "),_+=a[D]}E>0&&(_+=" "+h[E]),l?l=_+" و "+l:l=_}n=Math.floor(n/1e3),E++}return l+" دينارا"}function rl(n,t,r){let a,i,h;_t(n,Gt,d=>r(6,i=d)),_t(n,Rt,d=>r(20,h=d));let l={clientId:null,clientName:null,clientNumber:null,clientCin:null,clientJob:null,clientWorkplace:null,clientAddress:null,monthlyPayment:null,bankOrAgency:null,startDate:new Date().toISOString().split("T")[0]},E="",p=[],_=!1,F,D=!1;Mt(async()=>{const d=h.url.searchParams.get("clientId");d&&await A(d)});async function A(d){try{const T=await it.getById(d);if(T.success){const H=T.data;W(H)}else De(T.error||"Failed to load client","error")}catch(T){De(T.message||"Failed to load client","error")}finally{}}function V(){if(clearTimeout(F),E.length<2){r(2,p=[]),r(4,D=!1);return}r(4,D=!0),F=setTimeout(async()=>{try{const d=E.trim();let T=[];const H=parseInt(d);if(!isNaN(H)&&/^\d+$/.test(d))if(H>=1e7&&H<=99999999){const k=await it.search(null,null,null,d);if(k&&Array.isArray(k))T=k;else{const J=await it.search(null,null,null,null,null,null,null,d);J&&Array.isArray(J)&&(T=J)}}else{const k=await it.search(null,null,d);k&&Array.isArray(k)&&(T=k)}else{const k=await it.search(d);k&&Array.isArray(k)&&(T=k)}r(2,p=T.sort((k,J)=>{const I=k.fullName?.toLowerCase()===d.toLowerCase()||k.cin?.toString()===d||k.clientNumber?.toString()===d||k.workerNumber?.toString()===d,m=J.fullName?.toLowerCase()===d.toLowerCase()||J.cin?.toString()===d||J.clientNumber?.toString()===d||J.workerNumber?.toString()===d;return I&&!m?-1:!I&&m?1:(k.fullName||"").localeCompare(J.fullName||"")}))}catch{De("Failed to search clients. Please try again.","error"),r(2,p=[])}finally{r(4,D=!1)}},300)}function W(d){r(0,l.clientId=d.id,l),r(0,l.clientName=d.fullName,l),r(0,l.clientNumber=d.clientNumber,l),r(0,l.clientCin=d.cin,l),r(0,l.clientJob=d.jobTitle,l),r(0,l.clientWorkplace=d.workplace,l),r(0,l.clientAddress=d.address,l),r(2,p=[]),r(1,E="")}async function j(){if(!l.clientId){De(i("cessions.create.validation.select_client"),"error");return}if(!l.monthlyPayment||!l.bankOrAgency){De(i("cessions.create.validation.required_fields"),"error");return}r(3,_=!0);try{const d=await Ft.create(l);d.success?(De(i("cessions.create.validation.success"),"success"),Wt(`/cessions/${d.data.id}`)):De(d.error||i("cessions.create.validation.error"),"error")}catch(d){De(d.message||i("cessions.create.validation.error"),"error")}finally{r(3,_=!1)}}async function w(){if(!l.clientId){De("Please select a client first","error");return}if(!l.monthlyPayment||!l.bankOrAgency){De("Please fill in all required fields","error");return}const d={courtName:"",bookNumber:"",pageNumber:"",date:gt(new Date,"dd/MM/yyyy"),supplierTaxId:"",supplierName:"",supplierAddress:"",supplierBankAccount:"",workerNumber:l.clientNumber,fullName:l.clientName,cin:l.clientCin,address:l.clientAddress,workplace:l.clientWorkplace,jobTitle:l.clientJob,bankAccountNumber:l.bankOrAgency,itemDescription:"",amountInWords:sl(a),totalAmountNumeric:et(a),monthlyPayment:et(l.monthlyPayment),firstDeductionMonthArabic:gt(Kt(new Date,1),"MMMM yyyy",{locale:Ut})};await qt(d)}function N(){E=this.value,r(1,E)}const O=()=>{r(1,E=""),r(2,p=[])},B=d=>W(d),G=()=>{r(0,l.clientId=null,l),r(0,l.clientName=null,l),r(0,l.clientNumber=null,l),r(0,l.clientCin=null,l),r(0,l.clientJob=null,l),r(0,l.clientWorkplace=null,l),r(0,l.clientAddress=null,l)};function b(){l.monthlyPayment=xt(this.value),r(0,l)}function x(){l.bankOrAgency=this.value,r(0,l)}function U(){l.startDate=this.value,r(0,l)}return n.$$.update=()=>{n.$$.dirty&1&&r(5,a=l.monthlyPayment?l.monthlyPayment*18:0)},[l,E,p,_,D,a,i,V,W,j,w,N,O,B,G,b,x,U]}class vl extends Bt{constructor(t){super(),Ht(this,t,rl,ll,Tt,{})}}export{vl as component};
