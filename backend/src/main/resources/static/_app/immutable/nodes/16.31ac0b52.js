import{s as Ee,f as u,a as M,l as Y,g as d,h as E,c as U,y as W,d as m,m as G,j as a,N as ae,x as Xe,i as J,w as r,O as Pe,z as ee,Q as Ye,R as Re,I as ue,L as ze,H as ke,U as $e,n as re,P as Ge,e as ye,p as Je,V as Ke,o as We,v as Ze,r as et}from"../chunks/scheduler.fb6ad399.js";import{S as Ce,i as Ie,a as te,g as De,t as le,c as Te,b as me,d as pe,m as he,e as _e,h as tt}from"../chunks/index.19f0e15d.js";import{e as we}from"../chunks/each.eb6105d2.js";import{h as st,e as ve}from"../chunks/api.b4688d57.js";import{s as Ne,u as lt}from"../chunks/navigation.68a3d764.js";import{C as rt}from"../chunks/auto.c1974a99.js";import{E as qe}from"../chunks/ExpenseForm.d0776c87.js";import{M as nt}from"../chunks/Modal.fcf8bb1d.js";function Se(l,e,s){const t=l.slice();return t[10]=e[s],t}function Ae(l){let e,s,t;return{c(){e=u("div"),s=u("span"),t=Y(l[2]),this.h()},l(n){e=d(n,"DIV",{class:!0,role:!0});var o=E(e);s=d(o,"SPAN",{class:!0});var f=E(s);t=G(f,l[2]),f.forEach(m),o.forEach(m),this.h()},h(){a(s,"class","block sm:inline"),a(e,"class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"),a(e,"role","alert")},m(n,o){J(n,e,o),r(e,s),r(s,t)},p(n,o){o&4&&re(t,n[2])},d(n){n&&m(e)}}}function Fe(l){let e,s=l[10].charAt(0).toUpperCase()+l[10].slice(1)+"",t;return{c(){e=u("option"),t=Y(s),this.h()},l(n){e=d(n,"OPTION",{});var o=E(e);t=G(o,s),o.forEach(m),this.h()},h(){e.__value=l[10],ae(e,e.__value)},m(n,o){J(n,e,o),r(e,t)},p:ue,d(n){n&&m(e)}}}function Oe(l){let e,s="‚ü≥";return{c(){e=u("span"),e.textContent=s,this.h()},l(t){e=d(t,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-70ggdd"&&(e.textContent=s),this.h()},h(){a(e,"class","inline-block animate-spin mr-2")},m(t,n){J(t,e,n)},d(t){t&&m(e)}}}function at(l){let e,s,t,n,o="Source",f,i,c,b="Select a source",S,C,k,F="Amount (TND) *",v,y,g,T,x,I="Date *",O,w,X,R,$,H="Additional Notes",Z,D,p,V,j,B,K,se,q=l[2]&&Ae(l),P=we(l[3]),A=[];for(let h=0;h<P.length;h+=1)A[h]=Fe(Se(l,P,h));let L=l[1]&&Oe();return{c(){e=u("form"),q&&q.c(),s=M(),t=u("div"),n=u("label"),n.textContent=o,f=M(),i=u("select"),c=u("option"),c.textContent=b;for(let h=0;h<A.length;h+=1)A[h].c();S=M(),C=u("div"),k=u("label"),k.textContent=F,v=M(),y=u("input"),g=M(),T=u("div"),x=u("label"),x.textContent=I,O=M(),w=u("input"),X=M(),R=u("div"),$=u("label"),$.textContent=H,Z=M(),D=u("textarea"),p=M(),V=u("div"),j=u("button"),L&&L.c(),B=Y(`\r
      Add Income`),this.h()},l(h){e=d(h,"FORM",{class:!0});var N=E(e);q&&q.l(N),s=U(N),t=d(N,"DIV",{});var _=E(t);n=d(_,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),W(n)!=="svelte-1tv23ej"&&(n.textContent=o),f=U(_),i=d(_,"SELECT",{id:!0,class:!0});var Q=E(i);c=d(Q,"OPTION",{"data-svelte-h":!0}),W(c)!=="svelte-1twuwjc"&&(c.textContent=b);for(let de=0;de<A.length;de+=1)A[de].l(Q);Q.forEach(m),_.forEach(m),S=U(N),C=d(N,"DIV",{});var z=E(C);k=d(z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),W(k)!=="svelte-1wkgato"&&(k.textContent=F),v=U(z),y=d(z,"INPUT",{type:!0,id:!0,min:!0,step:!0,class:!0}),z.forEach(m),g=U(N),T=d(N,"DIV",{});var ne=E(T);x=d(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),W(x)!=="svelte-e3rulf"&&(x.textContent=I),O=U(ne),w=d(ne,"INPUT",{type:!0,id:!0,class:!0}),ne.forEach(m),X=U(N),R=d(N,"DIV",{});var oe=E(R);$=d(oe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),W($)!=="svelte-uaf79x"&&($.textContent=H),Z=U(oe),D=d(oe,"TEXTAREA",{id:!0,rows:!0,class:!0,placeholder:!0}),E(D).forEach(m),oe.forEach(m),p=U(N),V=d(N,"DIV",{class:!0});var ge=E(V);j=d(ge,"BUTTON",{type:!0,class:!0});var ie=E(j);L&&L.l(ie),B=G(ie,`\r
      Add Income`),ie.forEach(m),ge.forEach(m),N.forEach(m),this.h()},h(){a(n,"for","source"),a(n,"class","block text-sm font-medium text-gray-700 dark:text-gray-300"),c.__value="",ae(c,c.__value),a(i,"id","source"),a(i,"class","mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"),l[0].source===void 0&&Xe(()=>l[5].call(i)),a(k,"for","amount"),a(k,"class","block text-sm font-medium text-gray-700 dark:text-gray-300"),a(y,"type","number"),a(y,"id","amount"),a(y,"min","0"),a(y,"step","0.01"),a(y,"class","mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"),y.required=!0,a(x,"for","date"),a(x,"class","block text-sm font-medium text-gray-700 dark:text-gray-300"),a(w,"type","date"),a(w,"id","date"),a(w,"class","mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"),w.required=!0,a($,"for","description"),a($,"class","block text-sm font-medium text-gray-700 dark:text-gray-300"),a(D,"id","description"),a(D,"rows","3"),a(D,"class","mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"),a(D,"placeholder","Add any additional details about this income..."),a(j,"type","submit"),a(j,"class","inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"),j.disabled=l[1],a(V,"class","flex justify-end"),a(e,"class","space-y-4")},m(h,N){J(h,e,N),q&&q.m(e,null),r(e,s),r(e,t),r(t,n),r(t,f),r(t,i),r(i,c);for(let _=0;_<A.length;_+=1)A[_]&&A[_].m(i,null);Pe(i,l[0].source,!0),r(e,S),r(e,C),r(C,k),r(C,v),r(C,y),ae(y,l[0].amount),r(e,g),r(e,T),r(T,x),r(T,O),r(T,w),ae(w,l[0].date),r(e,X),r(e,R),r(R,$),r(R,Z),r(R,D),ae(D,l[0].description),r(e,p),r(e,V),r(V,j),L&&L.m(j,null),r(j,B),K||(se=[ee(i,"change",l[5]),ee(y,"input",l[6]),ee(w,"input",l[7]),ee(D,"input",l[8]),ee(e,"submit",Ye(l[4]))],K=!0)},p(h,[N]){if(h[2]?q?q.p(h,N):(q=Ae(h),q.c(),q.m(e,s)):q&&(q.d(1),q=null),N&8){P=we(h[3]);let _;for(_=0;_<P.length;_+=1){const Q=Se(h,P,_);A[_]?A[_].p(Q,N):(A[_]=Fe(Q),A[_].c(),A[_].m(i,null))}for(;_<A.length;_+=1)A[_].d(1);A.length=P.length}N&9&&Pe(i,h[0].source),N&9&&Re(y.value)!==h[0].amount&&ae(y,h[0].amount),N&9&&ae(w,h[0].date),N&9&&ae(D,h[0].description),h[1]?L||(L=Oe(),L.c(),L.m(j,B)):L&&(L.d(1),L=null),N&2&&(j.disabled=h[1])},i:ue,o:ue,d(h){h&&m(e),q&&q.d(),ze(A,h),L&&L.d(),K=!1,ke(se)}}}function ot(l,e,s){let{income:t={amount:"",source:"",date:new Date().toISOString().split("T")[0],description:""}}=e;const n=$e();let o=!1,f=null;const i=["salary","commission","investment","rental","other"];async function c(){try{if(s(1,o=!0),s(2,f=null),!t.amount||!t.date)throw new Error("Please fill in all required fields");const F=parseFloat(t.amount);if(isNaN(F)||F<=0)throw new Error("Amount must be a positive number");const v=await st.createIncome({...t,amount:F});if(v.success)Ne("Income added successfully","success"),n("submit",v.data),s(0,t={amount:"",source:"",date:new Date().toISOString().split("T")[0],description:""});else throw new Error(v.error)}catch(F){s(2,f=F.message),Ne(f,"error")}finally{s(1,o=!1)}}function b(){t.source=Ge(this),s(0,t),s(3,i)}function S(){t.amount=Re(this.value),s(0,t),s(3,i)}function C(){t.date=this.value,s(0,t),s(3,i)}function k(){t.description=this.value,s(0,t),s(3,i)}return l.$$set=F=>{"income"in F&&s(0,t=F.income)},[t,o,f,i,c,b,S,C,k]}class Qe extends Ce{constructor(e){super(),Ie(this,e,ot,at,Ee,{income:0})}}function Le(l){let e,s,t,n,o,f,i,c,b,S,C=l[1]==="expense"?"Expense":"Income",k,F,v,y,g,T,x,I,O="Close",w,X,R;const $=[ct,it],H=[];function Z(D,p){return D[1]==="expense"?0:1}return y=Z(l),g=H[y]=$[y](l),{c(){e=u("div"),s=u("div"),t=u("div"),n=M(),o=u("div"),f=u("div"),i=u("div"),c=u("div"),b=u("h3"),S=Y("Add "),k=Y(C),F=M(),v=u("div"),g.c(),T=M(),x=u("div"),I=u("button"),I.textContent=O,this.h()},l(D){e=d(D,"DIV",{class:!0,"aria-labelledby":!0,role:!0,"aria-modal":!0});var p=E(e);s=d(p,"DIV",{class:!0});var V=E(s);t=d(V,"DIV",{class:!0,"aria-hidden":!0}),E(t).forEach(m),n=U(V),o=d(V,"DIV",{class:!0});var j=E(o);f=d(j,"DIV",{class:!0});var B=E(f);i=d(B,"DIV",{class:!0});var K=E(i);c=d(K,"DIV",{class:!0});var se=E(c);b=d(se,"H3",{class:!0,id:!0});var q=E(b);S=G(q,"Add "),k=G(q,C),q.forEach(m),F=U(se),v=d(se,"DIV",{class:!0});var P=E(v);g.l(P),P.forEach(m),se.forEach(m),K.forEach(m),B.forEach(m),T=U(j),x=d(j,"DIV",{class:!0});var A=E(x);I=d(A,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),W(I)!=="svelte-1nn5y17"&&(I.textContent=O),A.forEach(m),j.forEach(m),V.forEach(m),p.forEach(m),this.h()},h(){a(t,"class","fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"),a(t,"aria-hidden","true"),a(b,"class","text-lg leading-6 font-medium text-gray-900"),a(b,"id","modal-title"),a(v,"class","mt-4"),a(c,"class","mt-3 text-center sm:mt-0 sm:text-left w-full"),a(i,"class","sm:flex sm:items-start"),a(f,"class","bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"),a(I,"type","button"),a(I,"class","mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"),a(x,"class","bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"),a(o,"class","inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"),a(s,"class","flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"),a(e,"class","fixed inset-0 z-50 overflow-y-auto"),a(e,"aria-labelledby","modal-title"),a(e,"role","dialog"),a(e,"aria-modal","true")},m(D,p){J(D,e,p),r(e,s),r(s,t),r(s,n),r(s,o),r(o,f),r(f,i),r(i,c),r(c,b),r(b,S),r(b,k),r(c,F),r(c,v),H[y].m(v,null),r(o,T),r(o,x),r(x,I),w=!0,X||(R=[ee(t,"click",l[2]),ee(I,"click",l[2])],X=!0)},p(D,p){(!w||p&2)&&C!==(C=D[1]==="expense"?"Expense":"Income")&&re(k,C);let V=y;y=Z(D),y===V?H[y].p(D,p):(De(),le(H[V],1,1,()=>{H[V]=null}),Te(),g=H[y],g?g.p(D,p):(g=H[y]=$[y](D),g.c()),te(g,1),g.m(v,null))},i(D){w||(te(g),w=!0)},o(D){le(g),w=!1},d(D){D&&m(e),H[y].d(),X=!1,ke(R)}}}function it(l){let e,s;return e=new Qe({}),e.$on("success",l[3]),{c(){me(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,n){he(e,t,n),s=!0},p:ue,i(t){s||(te(e.$$.fragment,t),s=!0)},o(t){le(e.$$.fragment,t),s=!1},d(t){_e(e,t)}}}function ct(l){let e,s;return e=new qe({}),e.$on("success",l[3]),{c(){me(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,n){he(e,t,n),s=!0},p:ue,i(t){s||(te(e.$$.fragment,t),s=!0)},o(t){le(e.$$.fragment,t),s=!1},d(t){_e(e,t)}}}function ut(l){let e,s,t=l[0]&&Le(l);return{c(){t&&t.c(),e=ye()},l(n){t&&t.l(n),e=ye()},m(n,o){t&&t.m(n,o),J(n,e,o),s=!0},p(n,[o]){n[0]?t?(t.p(n,o),o&1&&te(t,1)):(t=Le(n),t.c(),te(t,1),t.m(e.parentNode,e)):t&&(De(),le(t,1,1,()=>{t=null}),Te())},i(n){s||(te(t),s=!0)},o(n){le(t),s=!1},d(n){n&&m(e),t&&t.d(n)}}}function dt(l,e,s){let{show:t=!1}=e,{type:n="expense"}=e;const o=$e();function f(){s(0,t=!1)}function i(c){o("success",c),s(0,t=!1)}return l.$$set=c=>{"show"in c&&s(0,t=c.show),"type"in c&&s(1,n=c.type)},[t,n,f,i]}class ft extends Ce{constructor(e){super(),Ie(this,e,dt,ut,Ee,{show:0,type:1})}}function Me(l,e,s){const t=l.slice();return t[36]=e[s],t}function mt(l){let e,s,t,n="Total Income",o,f,i=ce(l[2]?.totalIncome||0)+"",c,b,S,C,k="Total Expenses",F,v,y=ce(l[2]?.totalExpenses||0)+"",g,T,x,I,O="Net Profit",w,X,R=ce(l[2]?.profit||0)+"",$,H,Z,D,p,V='<h3 class="text-lg font-medium text-gray-900 mb-4">Expense Distribution</h3> <div class="h-64"><canvas id="expensesChart"></canvas></div>',j,B,K,se="Recent Transactions",q,P,A,L=we([...l[0],...l[1]].sort(l[20])),h=[];for(let _=0;_<L.length;_+=1)h[_]=Ue(Me(l,L,_));let N=l[8]>1&&je(l);return{c(){e=u("div"),s=u("div"),t=u("h3"),t.textContent=n,o=M(),f=u("p"),c=Y(i),b=M(),S=u("div"),C=u("h3"),C.textContent=k,F=M(),v=u("p"),g=Y(y),T=M(),x=u("div"),I=u("h3"),I.textContent=O,w=M(),X=u("p"),$=Y(R),Z=M(),D=u("div"),p=u("div"),p.innerHTML=V,j=M(),B=u("div"),K=u("h3"),K.textContent=se,q=M(),P=u("div");for(let _=0;_<h.length;_+=1)h[_].c();A=M(),N&&N.c(),this.h()},l(_){e=d(_,"DIV",{class:!0});var Q=E(e);s=d(Q,"DIV",{class:!0});var z=E(s);t=d(z,"H3",{class:!0,"data-svelte-h":!0}),W(t)!=="svelte-jliia5"&&(t.textContent=n),o=U(z),f=d(z,"P",{class:!0});var ne=E(f);c=G(ne,i),ne.forEach(m),z.forEach(m),b=U(Q),S=d(Q,"DIV",{class:!0});var oe=E(S);C=d(oe,"H3",{class:!0,"data-svelte-h":!0}),W(C)!=="svelte-hdbx33"&&(C.textContent=k),F=U(oe),v=d(oe,"P",{class:!0});var ge=E(v);g=G(ge,y),ge.forEach(m),oe.forEach(m),T=U(Q),x=d(Q,"DIV",{class:!0});var ie=E(x);I=d(ie,"H3",{class:!0,"data-svelte-h":!0}),W(I)!=="svelte-1y3awnv"&&(I.textContent=O),w=U(ie),X=d(ie,"P",{class:!0});var de=E(X);$=G(de,R),de.forEach(m),ie.forEach(m),Q.forEach(m),Z=U(_),D=d(_,"DIV",{class:!0});var be=E(D);p=d(be,"DIV",{class:!0,"data-svelte-h":!0}),W(p)!=="svelte-iaf0js"&&(p.innerHTML=V),j=U(be),B=d(be,"DIV",{class:!0});var fe=E(B);K=d(fe,"H3",{class:!0,"data-svelte-h":!0}),W(K)!=="svelte-1kltnva"&&(K.textContent=se),q=U(fe),P=d(fe,"DIV",{class:!0});var Ve=E(P);for(let xe=0;xe<h.length;xe+=1)h[xe].l(Ve);Ve.forEach(m),A=U(fe),N&&N.l(fe),fe.forEach(m),be.forEach(m),this.h()},h(){a(t,"class","text-lg font-medium text-gray-900 mb-2"),a(f,"class","text-3xl font-bold text-green-600"),a(s,"class","bg-white rounded-lg shadow p-6"),a(C,"class","text-lg font-medium text-gray-900 mb-2"),a(v,"class","text-3xl font-bold text-red-600"),a(S,"class","bg-white rounded-lg shadow p-6"),a(I,"class","text-lg font-medium text-gray-900 mb-2"),a(X,"class",H="text-3xl font-bold "+(l[2]?.profit>=0?"text-green-600":"text-red-600")),a(x,"class","bg-white rounded-lg shadow p-6"),a(e,"class","grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"),a(p,"class","bg-white rounded-lg shadow p-6"),a(K,"class","text-lg font-medium text-gray-900 mb-4"),a(P,"class","space-y-4"),a(B,"class","bg-white rounded-lg shadow p-6"),a(D,"class","grid grid-cols-1 md:grid-cols-2 gap-8")},m(_,Q){J(_,e,Q),r(e,s),r(s,t),r(s,o),r(s,f),r(f,c),r(e,b),r(e,S),r(S,C),r(S,F),r(S,v),r(v,g),r(e,T),r(e,x),r(x,I),r(x,w),r(x,X),r(X,$),J(_,Z,Q),J(_,D,Q),r(D,p),r(D,j),r(D,B),r(B,K),r(B,q),r(B,P);for(let z=0;z<h.length;z+=1)h[z]&&h[z].m(P,null);r(B,A),N&&N.m(B,null)},p(_,Q){if(Q[0]&4&&i!==(i=ce(_[2]?.totalIncome||0)+"")&&re(c,i),Q[0]&4&&y!==(y=ce(_[2]?.totalExpenses||0)+"")&&re(g,y),Q[0]&4&&R!==(R=ce(_[2]?.profit||0)+"")&&re($,R),Q[0]&4&&H!==(H="text-3xl font-bold "+(_[2]?.profit>=0?"text-green-600":"text-red-600"))&&a(X,"class",H),Q[0]&1539){L=we([..._[0],..._[1]].sort(_[20]));let z;for(z=0;z<L.length;z+=1){const ne=Me(_,L,z);h[z]?h[z].p(ne,Q):(h[z]=Ue(ne),h[z].c(),h[z].m(P,null))}for(;z<h.length;z+=1)h[z].d(1);h.length=L.length}_[8]>1?N?N.p(_,Q):(N=je(_),N.c(),N.m(B,null)):N&&(N.d(1),N=null)},d(_){_&&(m(e),m(Z),m(D)),ze(h,_),N&&N.d()}}}function pt(l){let e,s,t;return{c(){e=u("div"),s=u("span"),t=Y(l[4]),this.h()},l(n){e=d(n,"DIV",{class:!0,role:!0});var o=E(e);s=d(o,"SPAN",{class:!0});var f=E(s);t=G(f,l[4]),f.forEach(m),o.forEach(m),this.h()},h(){a(s,"class","block sm:inline"),a(e,"class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"),a(e,"role","alert")},m(n,o){J(n,e,o),r(e,s),r(s,t)},p(n,o){o[0]&16&&re(t,n[4])},d(n){n&&m(e)}}}function ht(l){let e,s='<div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>';return{c(){e=u("div"),e.innerHTML=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-6w35z4"&&(e.innerHTML=s),this.h()},h(){a(e,"class","flex justify-center items-center h-64")},m(t,n){J(t,e,n)},p:ue,d(t){t&&m(e)}}}function Ue(l){let e,s,t,n=(l[36].category||l[36].source||"Uncategorized")+"",o,f,i,c=He(l[36].date)+"",b,S,C,k=ce(l[36].amount)+"",F,v,y;return{c(){e=u("div"),s=u("div"),t=u("p"),o=Y(n),f=M(),i=u("p"),b=Y(c),S=M(),C=u("p"),F=Y(k),y=M(),this.h()},l(g){e=d(g,"DIV",{class:!0});var T=E(e);s=d(T,"DIV",{});var x=E(s);t=d(x,"P",{class:!0});var I=E(t);o=G(I,n),I.forEach(m),f=U(x),i=d(x,"P",{class:!0});var O=E(i);b=G(O,c),O.forEach(m),x.forEach(m),S=U(T),C=d(T,"P",{class:!0});var w=E(C);F=G(w,k),w.forEach(m),y=U(T),T.forEach(m),this.h()},h(){a(t,"class","font-medium text-gray-900"),a(i,"class","text-sm text-gray-500"),a(C,"class",v="font-medium "+(l[36].amount>=0?"text-green-600":"text-red-600")),a(e,"class","flex items-center justify-between p-4 bg-gray-50 rounded-lg")},m(g,T){J(g,e,T),r(e,s),r(s,t),r(t,o),r(s,f),r(s,i),r(i,b),r(e,S),r(e,C),r(C,F),r(e,y)},p(g,T){T[0]&1539&&n!==(n=(g[36].category||g[36].source||"Uncategorized")+"")&&re(o,n),T[0]&1539&&c!==(c=He(g[36].date)+"")&&re(b,c),T[0]&1539&&k!==(k=ce(g[36].amount)+"")&&re(F,k),T[0]&1539&&v!==(v="font-medium "+(g[36].amount>=0?"text-green-600":"text-red-600"))&&a(C,"class",v)},d(g){g&&m(e)}}}function je(l){let e,s,t,n,o,f,i,c,b=l[7]+1+"",S,C,k,F,v,y,g,T,x,I;return{c(){e=u("div"),s=u("button"),t=Y("Previous"),f=M(),i=u("span"),c=Y("Page "),S=Y(b),C=Y(" of "),k=Y(l[8]),F=M(),v=u("button"),y=Y("Next"),this.h()},l(O){e=d(O,"DIV",{class:!0});var w=E(e);s=d(w,"BUTTON",{class:!0});var X=E(s);t=G(X,"Previous"),X.forEach(m),f=U(w),i=d(w,"SPAN",{class:!0});var R=E(i);c=G(R,"Page "),S=G(R,b),C=G(R," of "),k=G(R,l[8]),R.forEach(m),F=U(w),v=d(w,"BUTTON",{class:!0});var $=E(v);y=G($,"Next"),$.forEach(m),w.forEach(m),this.h()},h(){a(s,"class",n="px-3 py-1 border rounded "+(l[7]===0?"opacity-50 cursor-not-allowed":"hover:bg-gray-100")),s.disabled=o=l[7]===0,a(i,"class","px-3 py-1"),a(v,"class",g="px-3 py-1 border rounded "+(l[7]===l[8]-1?"opacity-50 cursor-not-allowed":"hover:bg-gray-100")),v.disabled=T=l[7]===l[8]-1,a(e,"class","flex justify-center mt-4 gap-2")},m(O,w){J(O,e,w),r(e,s),r(s,t),r(e,f),r(e,i),r(i,c),r(i,S),r(i,C),r(i,k),r(e,F),r(e,v),r(v,y),x||(I=[ee(s,"click",l[21]),ee(v,"click",l[22])],x=!0)},p(O,w){w[0]&128&&n!==(n="px-3 py-1 border rounded "+(O[7]===0?"opacity-50 cursor-not-allowed":"hover:bg-gray-100"))&&a(s,"class",n),w[0]&128&&o!==(o=O[7]===0)&&(s.disabled=o),w[0]&128&&b!==(b=O[7]+1+"")&&re(S,b),w[0]&256&&re(k,O[8]),w[0]&384&&g!==(g="px-3 py-1 border rounded "+(O[7]===O[8]-1?"opacity-50 cursor-not-allowed":"hover:bg-gray-100"))&&a(v,"class",g),w[0]&384&&T!==(T=O[7]===O[8]-1)&&(v.disabled=T)},d(O){O&&m(e),x=!1,ke(I)}}}function _t(l){let e,s;return e=new Qe({}),e.$on("submit",l[25]),{c(){me(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,n){he(e,t,n),s=!0},p:ue,i(t){s||(te(e.$$.fragment,t),s=!0)},o(t){le(e.$$.fragment,t),s=!1},d(t){_e(e,t)}}}function gt(l){let e,s;return e=new qe({}),e.$on("submit",l[24]),{c(){me(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,n){he(e,t,n),s=!0},p:ue,i(t){s||(te(e.$$.fragment,t),s=!0)},o(t){le(e.$$.fragment,t),s=!1},d(t){_e(e,t)}}}function vt(l){let e,s,t,n;const o=[gt,_t],f=[];function i(c,b){return c[6]==="expense"?0:1}return e=i(l),s=f[e]=o[e](l),{c(){s.c(),t=ye()},l(c){s.l(c),t=ye()},m(c,b){f[e].m(c,b),J(c,t,b),n=!0},p(c,b){let S=e;e=i(c),e===S?f[e].p(c,b):(De(),le(f[S],1,1,()=>{f[S]=null}),Te(),s=f[e],s?s.p(c,b):(s=f[e]=o[e](c),s.c()),te(s,1),s.m(t.parentNode,t))},i(c){n||(te(s),n=!0)},o(c){le(s),n=!1},d(c){c&&m(t),f[e].d(c)}}}function bt(l){let e,s,t,n="Monthly Expense and Profit Tracker",o,f,i,c,b,S="Add Expense",C,k,F="Add Income",v,y,g,T,x,I,O,w,X;function R(p,V){return p[3]?ht:p[4]?pt:mt}let $=R(l),H=$(l);function Z(p){l[23](p)}let D={type:l[6]};return l[5]!==void 0&&(D.show=l[5]),g=new ft({props:D}),Je.push(()=>tt(g,"show",Z)),g.$on("success",l[16]),I=new nt({props:{$$slots:{default:[vt]},$$scope:{ctx:l}}}),I.$on("close",l[26]),{c(){e=u("div"),s=u("div"),t=u("h1"),t.textContent=n,o=M(),f=u("div"),i=u("input"),c=M(),b=u("button"),b.textContent=S,C=M(),k=u("button"),k.textContent=F,v=M(),H.c(),y=M(),me(g.$$.fragment),x=M(),me(I.$$.fragment),this.h()},l(p){e=d(p,"DIV",{class:!0});var V=E(e);s=d(V,"DIV",{class:!0});var j=E(s);t=d(j,"H1",{class:!0,"data-svelte-h":!0}),W(t)!=="svelte-1i6td67"&&(t.textContent=n),o=U(j),f=d(j,"DIV",{class:!0});var B=E(f);i=d(B,"INPUT",{type:!0,class:!0}),c=U(B),b=d(B,"BUTTON",{class:!0,"data-svelte-h":!0}),W(b)!=="svelte-1k7kvik"&&(b.textContent=S),C=U(B),k=d(B,"BUTTON",{class:!0,"data-svelte-h":!0}),W(k)!=="svelte-1do3whd"&&(k.textContent=F),B.forEach(m),j.forEach(m),v=U(V),H.l(V),V.forEach(m),y=U(p),pe(g.$$.fragment,p),x=U(p),pe(I.$$.fragment,p),this.h()},h(){a(t,"class","text-2xl font-bold text-gray-900"),a(i,"type","month"),a(i,"class","block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm"),a(b,"class","bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"),a(k,"class","bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"),a(f,"class","flex space-x-4"),a(s,"class","flex justify-between items-center mb-8"),a(e,"class","container mx-auto px-4 py-8")},m(p,V){J(p,e,V),r(e,s),r(s,t),r(s,o),r(s,f),r(f,i),ae(i,l[11].start),r(f,c),r(f,b),r(f,C),r(f,k),r(e,v),H.m(e,null),J(p,y,V),he(g,p,V),J(p,x,V),he(I,p,V),O=!0,w||(X=[ee(i,"input",l[17]),ee(i,"change",l[14]),ee(b,"click",l[18]),ee(k,"click",l[19])],w=!0)},p(p,V){V[0]&2048&&ae(i,p[11].start),$===($=R(p))&&H?H.p(p,V):(H.d(1),H=$(p),H&&(H.c(),H.m(e,null)));const j={};V[0]&64&&(j.type=p[6]),!T&&V[0]&32&&(T=!0,j.show=p[5],Ke(()=>T=!1)),g.$set(j);const B={};V[0]&96|V[1]&256&&(B.$$scope={dirty:V,ctx:p}),I.$set(B)},i(p){O||(te(g.$$.fragment,p),te(I.$$.fragment,p),O=!0)},o(p){le(g.$$.fragment,p),le(I.$$.fragment,p),O=!1},d(p){p&&(m(e),m(y),m(x)),H.d(),_e(g,p),_e(I,p),w=!1,ke(X)}}}let Be=10;function ce(l){return new Intl.NumberFormat("en-US",{style:"currency",currency:"TND"}).format(l)}function He(l){return new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function yt(l,e,s){let t=new Date,n=t.getFullYear(),o=t.getMonth()+1,f=[],i=[],c=null,b=!0,S=null,C=null,k=!1,F="expense",v=0,y=0,g="date",T="desc",x={start:new Date(n,o-1,1).toISOString().split("T")[0],end:new Date(n,o,0).toISOString().split("T")[0]};We(()=>{I()}),Ze(()=>{C&&C.destroy()});async function I(){s(3,b=!0),s(4,S=null);try{const P=et(lt)?.id;if(!P)throw new Error("User not authenticated");const[A,L,h]=await Promise.all([ve.financial.getExpensesByDateRange(P,x.start,x.end,v,Be),ve.financial.getIncomesByDateRange(P,x.start,x.end,v,Be),ve.financial.getMonthlySummary(P,n,o)]);A.success&&L.success&&h.success?(s(0,f=A.data.content),s(1,i=L.data.content),s(8,y=Math.max(A.data.totalPages,L.data.totalPages)),s(2,c=h.data),O()):s(4,S="Failed to load financial data")}catch{s(4,S="Failed to load financial data")}finally{s(3,b=!1)}}function O(){C&&C.destroy();const P=document.getElementById("expensesChart");if(!P||!c)return;const A=f.reduce((L,h)=>(L[h.category]=(L[h.category]||0)+h.amount,L),{});C=new rt(P,{type:"pie",data:{labels:Object.keys(A),datasets:[{data:Object.values(A),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40"]}]},options:{responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Expenses by Category"}}}})}function w(P){s(7,v=P),I()}function X(){s(7,v=0),I()}function R(P){s(6,F=P),s(5,k=!0)}function $(){I()}function H(){x.start=this.value,s(11,x)}const Z=()=>R("expense"),D=()=>R("income"),p=(P,A)=>{const L=P[g],h=A[g];return T==="asc"?L>h?1:-1:L<h?1:-1},V=()=>w(v-1),j=()=>w(v+1);function B(P){k=P,s(5,k)}const K=async P=>{(await ve.financial.createExpense(P.detail)).success&&(s(5,k=!1),I())},se=async P=>{(await ve.financial.createIncome(P.detail)).success&&(s(5,k=!1),I())},q=()=>s(5,k=!1);return l.$$.update=()=>{l.$$.dirty[0]&3&&[...f,...i].sort((P,A)=>new Date(A.date)-new Date(P.date))},new Date(n,o-1).toLocaleString("default",{month:"long"}),[f,i,c,b,S,k,F,v,y,g,T,x,I,w,X,R,$,H,Z,D,p,V,j,B,K,se,q]}class Vt extends Ce{constructor(e){super(),Ie(this,e,yt,bt,Ee,{},null,[-1,-1])}}export{Vt as component};
