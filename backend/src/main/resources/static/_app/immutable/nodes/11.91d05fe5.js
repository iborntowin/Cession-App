import{s as be,a as M,f as h,l as B,J as we,d as _,c as S,g as v,h as m,m as R,y as J,j as f,L as X,x as Ee,i as Y,w as s,M as ue,z as he,n as U,I as re,H as De,u as Ae,o as Ie,A as ne,N as xe,K as Ne}from"../chunks/scheduler.55755e91.js";import{e as ve}from"../chunks/each.8720bd6f.js";import{S as Te,i as ke}from"../chunks/index.d2ed93bc.js";import{c as Le,a as _e}from"../chunks/api.20dd9789.js";import{s as oe,l as te}from"../chunks/navigation.fbd60083.js";import"../chunks/index.c6708bed.js";import{f as Ve}from"../chunks/index.7c030542.js";function pe(a,e,t){const n=a.slice();return n[13]=e[t],n}function me(a){let e,t,n;return{c(){e=h("a"),t=B("Add New Cession"),this.h()},l(o){e=v(o,"A",{href:!0,class:!0});var r=m(e);t=R(r,"Add New Cession"),r.forEach(_),this.h()},h(){f(e,"href",n=`/clients/${a[0].id}/cessions/new`),f(e,"class","btn btn-primary")},m(o,r){Y(o,e,r),s(e,t)},p(o,r){r&1&&n!==(n=`/clients/${o[0].id}/cessions/new`)&&f(e,"href",n)},d(o){o&&_(e)}}}function ge(a){let e,t,n="Client Information",o,r,p,u,c="Full Name",i,C,d=a[5].fullName+"",A,L,V,l,w="CIN (ID Number)",x,F,P=a[5].cin+"",I;return{c(){e=h("div"),t=h("h2"),t.textContent=n,o=M(),r=h("div"),p=h("div"),u=h("p"),u.textContent=c,i=M(),C=h("p"),A=B(d),L=M(),V=h("div"),l=h("p"),l.textContent=w,x=M(),F=h("p"),I=B(P),this.h()},l(b){e=v(b,"DIV",{class:!0});var N=m(e);t=v(N,"H2",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-27hnvw"&&(t.textContent=n),o=S(N),r=v(N,"DIV",{class:!0});var E=m(r);p=v(E,"DIV",{});var q=m(p);u=v(q,"P",{class:!0,"data-svelte-h":!0}),J(u)!=="svelte-y4vv6"&&(u.textContent=c),i=S(q),C=v(q,"P",{class:!0});var O=m(C);A=R(O,d),O.forEach(_),q.forEach(_),L=S(E),V=v(E,"DIV",{});var z=m(V);l=v(z,"P",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-z48v35"&&(l.textContent=w),x=S(z),F=v(z,"P",{class:!0});var y=m(F);I=R(y,P),y.forEach(_),z.forEach(_),E.forEach(_),N.forEach(_),this.h()},h(){f(t,"class","text-lg font-semibold mb-2"),f(u,"class","text-sm text-gray-500"),f(C,"class","font-medium"),f(l,"class","text-sm text-gray-500"),f(F,"class","font-medium"),f(r,"class","grid grid-cols-2 gap-4"),f(e,"class","card mb-6")},m(b,N){Y(b,e,N),s(e,t),s(e,o),s(e,r),s(r,p),s(p,u),s(p,i),s(p,C),s(C,A),s(r,L),s(r,V),s(V,l),s(V,x),s(V,F),s(F,I)},p(b,N){N&32&&d!==(d=b[5].fullName+"")&&U(A,d),N&32&&P!==(P=b[5].cin+"")&&U(I,P)},d(b){b&&_(e)}}}function Pe(a){let e,t,n,o='<tr><th class="py-3 px-4 text-left">ID</th> <th class="py-3 px-4 text-left">Start Date</th> <th class="py-3 px-4 text-left">Amount</th> <th class="py-3 px-4 text-left">Status</th> <th class="py-3 px-4 text-center">Actions</th></tr>',r,p,u=ve(a[4]),c=[];for(let i=0;i<u.length;i+=1)c[i]=ye(pe(a,u,i));return{c(){e=h("div"),t=h("table"),n=h("thead"),n.innerHTML=o,r=M(),p=h("tbody");for(let i=0;i<c.length;i+=1)c[i].c();this.h()},l(i){e=v(i,"DIV",{class:!0});var C=m(e);t=v(C,"TABLE",{class:!0});var d=m(t);n=v(d,"THEAD",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-h35q95"&&(n.innerHTML=o),r=S(d),p=v(d,"TBODY",{class:!0});var A=m(p);for(let L=0;L<c.length;L+=1)c[L].l(A);A.forEach(_),d.forEach(_),C.forEach(_),this.h()},h(){f(n,"class","bg-gray-100 text-gray-700"),f(p,"class","divide-y divide-gray-200"),f(t,"class","min-w-full bg-white rounded-lg overflow-hidden shadow"),f(e,"class","overflow-x-auto")},m(i,C){Y(i,e,C),s(e,t),s(t,n),s(t,r),s(t,p);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(p,null)},p(i,C){if(C&145){u=ve(i[4]);let d;for(d=0;d<u.length;d+=1){const A=pe(i,u,d);c[d]?c[d].p(A,C):(c[d]=ye(A),c[d].c(),c[d].m(p,null))}for(;d<c.length;d+=1)c[d].d(1);c.length=u.length}},d(i){i&&_(e),Ne(c,i)}}}function Oe(a){let e,t,n,o=a[2]||a[3]!=="all"?"Try different filters or ":"",r,p;return{c(){e=h("div"),t=h("p"),n=B("No cessions found. "),r=B(o),p=B(`
        Add a new cession to get started.`),this.h()},l(u){e=v(u,"DIV",{class:!0});var c=m(e);t=v(c,"P",{class:!0});var i=m(t);n=R(i,"No cessions found. "),r=R(i,o),p=R(i,`
        Add a new cession to get started.`),i.forEach(_),c.forEach(_),this.h()},h(){f(t,"class","text-gray-600"),f(e,"class","bg-gray-50 rounded-lg p-8 text-center")},m(u,c){Y(u,e,c),s(e,t),s(t,n),s(t,r),s(t,p)},p(u,c){c&12&&o!==(o=u[2]||u[3]!=="all"?"Try different filters or ":"")&&U(r,o)},d(u){u&&_(e)}}}function Me(a){let e,t="<p>Loading cessions...</p>";return{c(){e=h("div"),e.innerHTML=t,this.h()},l(n){e=v(n,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1cdxay0"&&(e.innerHTML=t),this.h()},h(){f(e,"class","text-center py-8")},m(n,o){Y(n,e,o)},p:re,d(n){n&&_(e)}}}function ye(a){let e,t,n=a[13].id+"",o,r,p,u,c=a[7](a[13].startDate)+"",i,C,d,A=Ce(a[13].totalLoanAmount)+"",L,V,l,w,x=a[13].status+"",F,P,I,b,N,E,q,O,z;return{c(){e=h("tr"),t=h("td"),o=B(n),r=M(),p=h("td"),u=h("span"),i=B(c),C=M(),d=h("td"),L=B(A),V=M(),l=h("td"),w=h("span"),F=B(x),I=M(),b=h("td"),N=h("div"),E=h("a"),q=B("View Details"),z=M(),this.h()},l(y){e=v(y,"TR",{class:!0});var D=m(e);t=v(D,"TD",{class:!0});var Q=m(t);o=R(Q,n),Q.forEach(_),r=S(D),p=v(D,"TD",{class:!0});var W=m(p);u=v(W,"SPAN",{dir:!0});var Z=m(u);i=R(Z,c),Z.forEach(_),W.forEach(_),C=S(D),d=v(D,"TD",{class:!0});var T=m(d);L=R(T,A),T.forEach(_),V=S(D),l=v(D,"TD",{class:!0});var k=m(l);w=v(k,"SPAN",{class:!0});var $=m(w);F=R($,x),$.forEach(_),k.forEach(_),I=S(D),b=v(D,"TD",{class:!0});var G=m(b);N=v(G,"DIV",{class:!0});var H=m(N);E=v(H,"A",{href:!0,class:!0});var g=m(E);q=R(g,"View Details"),g.forEach(_),H.forEach(_),G.forEach(_),z=S(D),D.forEach(_),this.h()},h(){f(t,"class","py-3 px-4"),f(u,"dir","ltr"),f(p,"class","py-3 px-4"),f(d,"class","py-3 px-4"),f(w,"class",P=`badge badge-${a[13].status.toLowerCase()}`),f(l,"class","py-3 px-4"),f(E,"href",O=`/clients/${a[0].id}/cessions/${a[13].id}`),f(E,"class","text-primary-600 hover:text-primary-800"),f(N,"class","flex justify-center space-x-2"),f(b,"class","py-3 px-4 text-center"),f(e,"class","hover:bg-gray-50")},m(y,D){Y(y,e,D),s(e,t),s(t,o),s(e,r),s(e,p),s(p,u),s(u,i),s(e,C),s(e,d),s(d,L),s(e,V),s(e,l),s(l,w),s(w,F),s(e,I),s(e,b),s(b,N),s(N,E),s(E,q),s(e,z)},p(y,D){D&16&&n!==(n=y[13].id+"")&&U(o,n),D&16&&c!==(c=y[7](y[13].startDate)+"")&&U(i,c),D&16&&A!==(A=Ce(y[13].totalLoanAmount)+"")&&U(L,A),D&16&&x!==(x=y[13].status+"")&&U(F,x),D&16&&P!==(P=`badge badge-${y[13].status.toLowerCase()}`)&&f(w,"class",P),D&17&&O!==(O=`/clients/${y[0].id}/cessions/${y[13].id}`)&&f(E,"href",O)},d(y){y&&_(e)}}}function Se(a){let e,t,n,o,r,p,u,c,i,C=a[5]?`${a[5].fullName}'s Cessions`:"Client Cessions",d,A,L,V,l,w,x,F,P,I,b,N="All Statuses",E,q="Active",O,z="Finished",y,D="Pending",Q,W,Z,T=a[5]&&me(a),k=a[5]&&ge(a);function $(g,j){return g[6]&&g[1].length===0?Me:g[4].length===0?Oe:Pe}let G=$(a),H=G(a);return{c(){e=M(),t=h("div"),n=h("div"),o=h("div"),r=h("a"),p=B("← Back to Client Details"),c=M(),i=h("h1"),d=B(C),A=M(),T&&T.c(),L=M(),k&&k.c(),V=M(),l=h("div"),w=h("div"),x=h("input"),F=M(),P=h("div"),I=h("select"),b=h("option"),b.textContent=N,E=h("option"),E.textContent=q,O=h("option"),O.textContent=z,y=h("option"),y.textContent=D,Q=M(),H.c(),this.h()},l(g){we("svelte-1bkru2w",document.head).forEach(_),e=S(g),t=v(g,"DIV",{});var K=m(t);n=v(K,"DIV",{class:!0});var se=m(n);o=v(se,"DIV",{});var le=m(o);r=v(le,"A",{href:!0,class:!0});var ie=m(r);p=R(ie,"← Back to Client Details"),ie.forEach(_),c=S(le),i=v(le,"H1",{class:!0});var ce=m(i);d=R(ce,C),ce.forEach(_),le.forEach(_),A=S(se),T&&T.l(se),se.forEach(_),L=S(K),k&&k.l(K),V=S(K),l=v(K,"DIV",{class:!0});var ae=m(l);w=v(ae,"DIV",{class:!0});var de=m(w);x=v(de,"INPUT",{type:!0,placeholder:!0,class:!0}),de.forEach(_),F=S(ae),P=v(ae,"DIV",{class:!0});var fe=m(P);I=v(fe,"SELECT",{class:!0});var ee=m(I);b=v(ee,"OPTION",{"data-svelte-h":!0}),J(b)!=="svelte-gifdaw"&&(b.textContent=N),E=v(ee,"OPTION",{"data-svelte-h":!0}),J(E)!=="svelte-1mh57he"&&(E.textContent=q),O=v(ee,"OPTION",{"data-svelte-h":!0}),J(O)!=="svelte-3rcc8e"&&(O.textContent=z),y=v(ee,"OPTION",{"data-svelte-h":!0}),J(y)!=="svelte-mygx0s"&&(y.textContent=D),ee.forEach(_),fe.forEach(_),ae.forEach(_),Q=S(K),H.l(K),K.forEach(_),this.h()},h(){document.title="Client Cessions | Cession Management",f(r,"href",u=`/clients/${a[0].id}`),f(r,"class","text-primary-600 hover:text-primary-800 mb-2 inline-block"),f(i,"class","text-2xl font-bold text-gray-800"),f(n,"class","flex justify-between items-center mb-6"),f(x,"type","text"),f(x,"placeholder","Search by bank or agency..."),f(x,"class","input"),f(w,"class","flex-grow"),b.__value="all",X(b,b.__value),E.__value="active",X(E,E.__value),O.__value="finished",X(O,O.__value),y.__value="pending",X(y,y.__value),f(I,"class","input"),a[3]===void 0&&Ee(()=>a[9].call(I)),f(P,"class","flex-shrink-0"),f(l,"class","mb-6 flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0")},m(g,j){Y(g,e,j),Y(g,t,j),s(t,n),s(n,o),s(o,r),s(r,p),s(o,c),s(o,i),s(i,d),s(n,A),T&&T.m(n,null),s(t,L),k&&k.m(t,null),s(t,V),s(t,l),s(l,w),s(w,x),X(x,a[2]),s(l,F),s(l,P),s(P,I),s(I,b),s(I,E),s(I,O),s(I,y),ue(I,a[3],!0),s(t,Q),H.m(t,null),W||(Z=[he(x,"input",a[8]),he(I,"change",a[9])],W=!0)},p(g,[j]){j&1&&u!==(u=`/clients/${g[0].id}`)&&f(r,"href",u),j&32&&C!==(C=g[5]?`${g[5].fullName}'s Cessions`:"Client Cessions")&&U(d,C),g[5]?T?T.p(g,j):(T=me(g),T.c(),T.m(n,null)):T&&(T.d(1),T=null),g[5]?k?k.p(g,j):(k=ge(g),k.c(),k.m(t,V)):k&&(k.d(1),k=null),j&4&&x.value!==g[2]&&X(x,g[2]),j&8&&ue(I,g[3]),G===(G=$(g))&&H?H.p(g,j):(H.d(1),H=G(g),H&&(H.c(),H.m(t,null)))},i:re,o:re,d(g){g&&(_(e),_(t)),T&&T.d(),k&&k.d(),H.d(),W=!1,De(Z)}}}function Ce(a){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND"}).format(a)}function Fe(a,e,t){let n,o;Ae(a,te,l=>t(6,o=l));let{data:r}=e,p=null,u=[],c="",i="all";Ie(async()=>{if(!r.id||r.id==="undefined"||r.id==="new"){oe("Cannot load cessions for an invalid client.","error");return}await C(),await d()});async function C(){ne(te,o=!0,o);try{const l=await Le.getById(r.id);l&&l.success&&l.data?t(5,p=l.data):oe("Client not found for cessions page.","error")}catch(l){oe(l.message||"Failed to load client details for cessions page","error")}finally{ne(te,o=!1,o)}}async function d(){ne(te,o=!0,o);try{try{const w=await _e.getAll()}catch{}const l=await _e.getByClientId(r.id);Array.isArray(l)?t(1,u=l):t(1,u=[])}catch(l){oe(l.message||"Failed to load cessions","error"),t(1,u=[])}finally{ne(te,o=!1,o)}}function A(l){return l?Ve(new Date(l),"dd/MM/yyyy"):"N/A"}function L(){c=this.value,t(2,c)}function V(){i=xe(this),t(3,i)}return a.$$set=l=>{"data"in l&&t(0,r=l.data)},a.$$.update=()=>{a.$$.dirty&14&&t(4,n=u.filter(l=>i==="all"||l.status&&l.status.toLowerCase()===i.toLowerCase()).filter(l=>{if(!c)return!0;const w=c.toLowerCase();return l.clientName&&l.clientName.toLowerCase().includes(w)||l.bankOrAgency&&l.bankOrAgency.toLowerCase().includes(w)||l.status&&l.status.toLowerCase().includes(w)||l.id&&l.id.toLowerCase().includes(w)})),a.$$.dirty&18},[r,u,c,i,n,p,o,A,L,V]}class Ke extends Te{constructor(e){super(),ke(this,e,Fe,Se,be,{data:0})}}export{Ke as component};
